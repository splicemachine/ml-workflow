{% extends 'base.html' %}

{% block css %}
{{ super() }}
<link rel="stylesheet" href="{{ url_for('static', filename='css/jquery.bootgrid.css') }}"/>
{% endblock %}

{% block content %}
<div class="welcome">
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-12">
                <div class="content">
                    <h2>Job Tracker</h2>
                    <p>The MLManager Director Job Tracker allows you to track
                        the status of your jobs, as well as carry out
                        governance of previous jobs. You can hit the refresh button on
                        the table to update. Additionally, you have the ability to export
                        the table content to your disk for offline analysis.
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>

<section class="statistics" style="color:black;">
    <div class="welcome">
        <div class="container-fluid">
            <div class="box" style='background-color: white; overflow:visible;'>
                <table data-toggle="bootgrid" data-ajax="true" data-url="/api/ui/get_jobs"
                       id="grid-data" class="table table-condensed table-hover table-striped">
                    <thead>
                    <tr>
                        <th data-column-id="ID" data-visible="false" data-type="numeric">Job ID</th>
                        <th data-column-id="TIMESTAMP" data-order='desc'>Timestamp</th>
                        <th data-column-id="USER" data-html='allow'>User</th>
                        <th data-column-id="HANDLER_NAME">Action</th>
                        <th data-column-id="TARGET_SERVICE" data-visible="false" data-html='allow'
                            data-sortable="false">Target
                        </th>
                        <th data-column-id="PAYLOAD" data-sortable="false" data-visible="false"
                            data-html='allow'>Job Payload
                        </th>
                        <th data-column-id="STATUS" data-html='allow'>Status</th>
                        <th data-column-id="LOGS" data-sortable="false" data-visible="false"
                            data-html='allow'>Detailed Status
                        </th>
                        <th data-column-id="MLFLOW_URL" data-sortable="false" data-visible="true"
                            data-html='allow'>
                            MLFlow Run URL
                        </th>
                    </tr>
                    </thead>
                </table>
            </div>
        </div>
    </div>
</section>
<section class="statistics" style="color:black">

    <div class="container-fluid">
        <div class="box">
            <button onclick='exportJSON()' class="button-outline button-group"><i
                    class="fas fa-file-export"></i> Export to
                JSON
            </button>
            <button onclick='exportCSV()' class="button-outline button-group"><i
                    class="fas fa-file-export"></i> Export to
                CSV
            </button>
            <button onclick='exportTXT()' class="button-outline button-group"><i
                    class="fas fa-file-export"></i> Export to
                TXT
            </button>
        </div>
        <br><br>
    </div>
    <br>
</section>
{% endblock %}

{% block scripts %}
{{ super() }}
<script src="{{ url_for('static', filename='js/FileSaver.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/tableExport.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/jquery.bootgrid.js') }}"></script>
<script src="{{ url_for('static', filename='js/export_functions.js') }}"></script>
<script>
    $("#grid-data").bootgrid(
    {
        "caseSensitive": false
    });
</script>
{% endblock %}